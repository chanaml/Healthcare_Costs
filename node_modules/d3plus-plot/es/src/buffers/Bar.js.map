{"version":3,"file":"Bar.js","sources":["../../../src/buffers/Bar.js"],"sourcesContent":["import {max, min, sum} from \"d3-array\";\nimport {nest} from \"d3-collection\";\n\nimport {default as ordinalBuffer} from \"./ordinalBuffer\";\n\n/**\n    Adds a buffer to either side of the non-discrete axis.\n    @param {Array} data\n    @param {D3Scale} x\n    @param {D3Scale} y\n    @param {Object} [config]\n    @param {Number} [buffer = 10]\n    @private\n*/\nexport default function(data, x, y, config, buffer = 10) {\n\n  const oppScale = this._discrete === \"x\" ? y : x;\n\n  const oppDomain = oppScale.domain().slice();\n\n  if (this._discrete === \"x\") oppDomain.reverse();\n\n  let negVals, posVals;\n  if (this._stacked) {\n    const groupedData = nest()\n      .key(d => d[this._discrete])\n      .entries(data)\n      .map(d => d.values.map(x => x[this._discrete === \"x\" ? \"y\" : \"x\"]));\n    posVals = groupedData.map(arr => sum(arr.filter(d => d > 0)));\n    negVals = groupedData.map(arr => sum(arr.filter(d => d < 0)));\n  }\n  else {\n    posVals = data.map(d => d[this._discrete === \"x\" ? \"y\" : \"x\"]);\n    negVals = posVals;\n  }\n  let bMax = oppScale(max(posVals));\n  if (bMax !== oppScale(0)) bMax += this._discrete === \"x\" ? -buffer : buffer;\n  bMax = oppScale.invert(bMax);\n\n  let bMin = oppScale(min(negVals));\n  if (bMin !== oppScale(0)) bMin += this._discrete === \"x\" ? buffer : -buffer;\n  bMin = oppScale.invert(bMin);\n\n  if (bMax > oppDomain[1]) oppDomain[1] = bMax;\n  if (bMin < oppDomain[0]) oppDomain[0] = bMin;\n\n  if (this._discrete === \"x\") oppDomain.reverse();\n\n  oppScale.domain(oppDomain);\n\n  const discreteScale = this._discrete === \"x\" ? x : y;\n  discreteScale.domain(ordinalBuffer(discreteScale.domain()));\n\n  return [x, y];\n\n}\n"],"names":["const","let","this"],"mappings":"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"}